<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulating Quantities of Interest in a Linear Model • simqi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating Quantities of Interest in a Linear Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simqi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/linear-model.html">Simulating Quantities of Interest in a Linear Model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulating Quantities of Interest in a Linear Model</h1>
            
      

      <div class="d-none name"><code>linear-model.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stevemisc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org" class="external-link">modelr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simqi</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://svmiller.com/stevethemes/">stevethemes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8675309</span><span class="op">)</span> <span class="co"># Jenny, I got your number...</span></span></code></pre></div>
<div class="section level2">
<h2 id="a-brief-description-of-the-data">A (Brief) Description of the Data<a class="anchor" aria-label="anchor" href="#a-brief-description-of-the-data"></a>
</h2>
<p><code>som_sample</code> is a subset of <a href="https://www.gu.se/en/som-institute/the-som-surveys" class="external-link">the SOM
surveys in Sweden</a>. It is the Swedish corollary to the General Social
Survey in the United States and offers a wide-reaching assessment of
Swedish public opinion about various aspects of society, politics, and
mass media. Deep knowledge about Sweden is not required for this
tutorial though some kind of comfort with modeling public opinion data
is assumed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">som_sample</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,841 × 14</span></span></span>
<span><span class="co">#&gt;     year  idnr lan      lptrust satisdem trust_rf attitude_eu   age female  edu3</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>003 Dalarna…   1.08         3        4           4    58      0     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>004 Halland…  -<span style="color: #BB0000;">0.296</span>        3        3           3    76      1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>005 Örebro …  -<span style="color: #BB0000;">0.343</span>        2        2           4    66      0     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>007 Västman…   0.512        4        3           4    62      0     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>008 Stockho…   1.08         4        4           4    46      1     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>009 Dalarna…  -<span style="color: #BB0000;">2.08</span>         1        1           1    24      0     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>011 Västman…   0.346        3        3           3    69      0     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>012 Söderma…  -<span style="color: #BB0000;">2.08</span>         1        5           2    85      0     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>013 Västra …  -<span style="color: #BB0000;">0.106</span>        3        3           3    68      1     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">10</span>014 Östergö…   1.08         3        2           4    31      1     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,831 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: ideo &lt;dbl&gt;, hinc &lt;dbl&gt;, resarea &lt;dbl&gt;, interestp &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-simple-linear-model-with-no-frills">A Simple Linear Model with No Frills<a class="anchor" aria-label="anchor" href="#a-simple-linear-model-with-no-frills"></a>
</h2>
<p>Let’s run a simple linear model regressing a respondent’s latent
political trust (<code>lptrust</code>) on their age (<code>age</code>,
in years), whether they self-identify as a woman or not
(<code>female</code>), and their educational attainment
(<code>edu3</code>) into “low” (1), “medium” (2), or “high” (3)
categories. <a href="https://svmiller.com/simqi/reference/som_sample.html" class="external-link">The
codebook</a> offers more information about how the political trust
variable is created. Understand, for now, that higher values in
<code>lptrust</code> = “more” political trust and the variable
approximates a standard normal distribution.</p>
<p>Let’s use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> to regress political trust on those
three things.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">lptrust</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">edu3</span>, <span class="va">som_sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = lptrust ~ age + female + edu3, data = som_sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.31830 -0.56330  0.01424  0.60836  2.90961 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) -0.5963148  0.0876567  -6.803 1.25e-11 ***</span></span>
<span><span class="co">#&gt; age          0.0004956  0.0009539   0.520    0.603    </span></span>
<span><span class="co">#&gt; female       0.2000629  0.0337581   5.926 3.47e-09 ***</span></span>
<span><span class="co">#&gt; edu3         0.2006343  0.0252937   7.932 3.07e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8922 on 2837 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.03823,    Adjusted R-squared:  0.03721 </span></span>
<span><span class="co">#&gt; F-statistic: 37.59 on 3 and 2837 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>We find no discernible effect of age on political trust. Partialing
out gender and education, young and old are not discernibly different in
their latent political trust. The effect of <code>female</code> and
<code>edu3</code> is positive and significant.</p>
<p>What if we wanted to unpack that gender difference further.
<code><a href="https://modelr.tidyverse.org/reference/data_grid.html" class="external-link">data_grid()</a></code> in <a href="https://modelr.tidyverse.org" class="external-link">modelr</a> can help us by
creating a hypothetical prediction grid based on the data and the model,
generating a hypothetical person with the median age (54) and
educational attainment (“medium”). This hypothetical person will differ
only in their gender. One is a woman and the other is not.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">som_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://modelr.tidyverse.org/reference/data_grid.html" class="external-link">data_grid</a></span><span class="op">(</span>.model <span class="op">=</span> <span class="va">M1</span>,</span>
<span>              female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">newdat</span></span>
<span></span>
<span><span class="va">newdat</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   female   age  edu3</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      0    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      1    54     2</span></span></code></pre></div>
<p><code><a href="../reference/sim_qi.html">sim_qi()</a></code> will take the model (<code>M1</code>) and the
prediction grid we created above as “new data” and simulate some
<code>nsim</code> values of the dependent variable (default: 1000) from
the model’s vector of coefficients and the variance-covariance matrix.
We can optionally toggle <code>return_newdata = TRUE</code> to help us
with post-processing.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_qi.html">sim_qi</a></span><span class="op">(</span><span class="va">M1</span>, nsim <span class="op">=</span> <span class="fl">100</span>, newdata <span class="op">=</span> <span class="va">newdat</span>, return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Sims</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 5</span></span></span>
<span><span class="co">#&gt;          y   sim female   age  edu3</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.156</span>      1      0    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  0.048<span style="text-decoration: underline;">4</span>     1      1    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.185</span>      2      0    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  0.014<span style="text-decoration: underline;">2</span>     2      1    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.154</span>      3      0    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  0.050<span style="text-decoration: underline;">9</span>     3      1    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.200</span>      4      0    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  0.089<span style="text-decoration: underline;">3</span>     4      1    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.163</span>      5      0    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  0.018<span style="text-decoration: underline;">7</span>     5      1    54     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre></div>
<p>The simulated values of latent political trust are returned as a
column called <code>y</code> in the <code>Sims</code> object we created.
From there, we can summarize these simulated values of political trust
comparing men and women like this.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sims</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>              mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>              upr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.95</span><span class="op">)</span>,</span>
<span>              .by <span class="op">=</span> <span class="va">female</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   female     lwr    mean     upr</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      0 -<span style="color: #BB0000;">0.214</span>  -<span style="color: #BB0000;">0.168</span>  -<span style="color: #BB0000;">0.128</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      1 -<span style="color: #BB0000;">0.011</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.032<span style="text-decoration: underline;">5</span>  0.077<span style="text-decoration: underline;">0</span></span></span></code></pre></div>
<p>There are certainly fancier summary techniques available, especially
visually, but the fundamental takeaway suggests that the mean simulated
values of political trust for this “typical woman” is .032 whereas it is
-.168 for this “typical man”. That’s a difference of about .20 on this
scale. If there were truly no differences between men and women in their
expected values of political trust, the simulations betray that. A 90%
interval summarizing the distribution for women has a lower bound of
-.011. The upper bound for men -.128. The two do not overlap.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sims</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>              mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>              upr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.95</span><span class="op">)</span>,</span>
<span>              .by <span class="op">=</span> <span class="va">female</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">cat</span>, <span class="va">mean</span>, ymin<span class="op">=</span><span class="va">lwr</span>, ymax<span class="op">=</span><span class="va">upr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://svmiller.com/reference/theme_steve.html">theme_steve</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Simulated Values of Political Trust (with 90% Intervals)"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"Simulated Values of Latent Political Trust, by Men and Women"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"A visual summary better emphasizes what the model communicates, and what the simulations are telling you."</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"?som_sample in {simqi} (by way of SOM)."</span><span class="op">)</span></span></code></pre></div>
<p><img src="linear-model_files/figure-html/unnamed-chunk-7-1.png" width="912"></p>
</div>
<div class="section level2">
<h2 id="interactive-effects">Interactive Effects<a class="anchor" aria-label="anchor" href="#interactive-effects"></a>
</h2>
<p>What if you were interested in an interactive relationship between
age and gender? <code>{simqi}</code> is flexible with that as well.
First, let’s center the age variable by subtracting it from its mean.
While it’s not strictly necessary for identifying interactive
relationships, it is really good practice to make sure there is a
naturally occurring zero for all things being interacted. While there is
no one with the mean age in the data (i.e. age can only be an integer),
we’ve at least shifted zero from newborns (who won’t appear in the data)
to the center of the distribution.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">som_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>c_age <span class="op">=</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">Data</span></span>
<span></span>
<span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">lptrust</span> <span class="op">~</span> <span class="va">c_age</span><span class="op">*</span><span class="va">female</span> <span class="op">+</span> <span class="va">edu3</span>, <span class="va">Data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = lptrust ~ c_age * female + edu3, data = Data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.37950 -0.55882  0.00423  0.62647  3.00678 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  -0.572262   0.062305  -9.185  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; c_age         0.003180   0.001340   2.374   0.0177 *  </span></span>
<span><span class="co">#&gt; female        0.200172   0.033716   5.937 3.25e-09 ***</span></span>
<span><span class="co">#&gt; edu3          0.200213   0.025262   7.925 3.24e-15 ***</span></span>
<span><span class="co">#&gt; c_age:female -0.005307   0.001862  -2.850   0.0044 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8911 on 2836 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.04098,    Adjusted R-squared:  0.03963 </span></span>
<span><span class="co">#&gt; F-statistic: 30.29 on 4 and 2836 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The results of this simple model suggest that 1) higher levels of age
coincide with more political trust among those that are not women, 2)
women of the average age have higher levels of political trust than
non-women, and 3) there is indeed a statistically significant
interaction between age and gender.</p>
<p>But what does that “look like”? Here, <code><a href="../reference/sim_qi.html">sim_qi()</a></code> comes to
the rescue. Let’s create another <code>newdata</code> data frame, but
this one where we also allow the age variable to take on all unique
values (to approximate the full range of age).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://modelr.tidyverse.org/reference/data_grid.html" class="external-link">data_grid</a></span><span class="op">(</span>.model <span class="op">=</span> <span class="va">M2</span>,</span>
<span>              female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>              c_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">c_age</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">newdat</span></span>
<span></span>
<span><span class="va">newdat</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 140 × 3</span></span></span>
<span><span class="co">#&gt;    female c_age  edu3</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      0 -<span style="color: #BB0000;">36.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      0 -<span style="color: #BB0000;">35.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      0 -<span style="color: #BB0000;">34.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      0 -<span style="color: #BB0000;">33.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      0 -<span style="color: #BB0000;">32.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      0 -<span style="color: #BB0000;">31.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      0 -<span style="color: #BB0000;">30.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      0 -<span style="color: #BB0000;">29.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      0 -<span style="color: #BB0000;">28.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0 -<span style="color: #BB0000;">27.2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 130 more rows</span></span></span></code></pre></div>
<p>Admittedly, getting used to transformed variables like this can be
wonky if you’re new. So, let’s get the actual age equivalents for
<code>c_age</code> just to have that information handy for
post-processing.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">c_age</span>, <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">newdat</span>, <span class="va">.</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">newdat</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(c_age)`</span></span>
<span></span>
<span><span class="va">newdat</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 140 × 4</span></span></span>
<span><span class="co">#&gt;    female c_age  edu3   age</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      0 -<span style="color: #BB0000;">36.2</span>     2    16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      0 -<span style="color: #BB0000;">35.2</span>     2    17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      0 -<span style="color: #BB0000;">34.2</span>     2    18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      0 -<span style="color: #BB0000;">33.2</span>     2    19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      0 -<span style="color: #BB0000;">32.2</span>     2    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      0 -<span style="color: #BB0000;">31.2</span>     2    21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      0 -<span style="color: #BB0000;">30.2</span>     2    22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      0 -<span style="color: #BB0000;">29.2</span>     2    23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      0 -<span style="color: #BB0000;">28.2</span>     2    24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0 -<span style="color: #BB0000;">27.2</span>     2    25</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 130 more rows</span></span></span></code></pre></div>
<p>Now, let <code><a href="../reference/sim_qi.html">sim_qi()</a></code> do its thing.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_qi.html">sim_qi</a></span><span class="op">(</span><span class="va">M2</span>, nsim <span class="op">=</span> <span class="fl">100</span>, newdata <span class="op">=</span> <span class="va">newdat</span>, return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Sims</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14,000 × 6</span></span></span>
<span><span class="co">#&gt;         y   sim female c_age  edu3   age</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.276</span>     1      0 -<span style="color: #BB0000;">36.2</span>     2    16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.272</span>     1      0 -<span style="color: #BB0000;">35.2</span>     2    17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.268</span>     1      0 -<span style="color: #BB0000;">34.2</span>     2    18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.265</span>     1      0 -<span style="color: #BB0000;">33.2</span>     2    19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.261</span>     1      0 -<span style="color: #BB0000;">32.2</span>     2    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.257</span>     1      0 -<span style="color: #BB0000;">31.2</span>     2    21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.254</span>     1      0 -<span style="color: #BB0000;">30.2</span>     2    22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.250</span>     1      0 -<span style="color: #BB0000;">29.2</span>     2    23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.246</span>     1      0 -<span style="color: #BB0000;">28.2</span>     2    24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.243</span>     1      0 -<span style="color: #BB0000;">27.2</span>     2    25</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13,990 more rows</span></span></span></code></pre></div>
<p>And summarize accordingly….</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sims</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Women"</span>, <span class="st">"Not Women"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>              mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>              upr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.95</span><span class="op">)</span>,</span>
<span>              .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cat</span>, <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">mean</span>, ymin<span class="op">=</span><span class="va">lwr</span>, ymax<span class="op">=</span><span class="va">upr</span>, color<span class="op">=</span><span class="va">cat</span>, linetype<span class="op">=</span><span class="va">cat</span>, fill<span class="op">=</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://svmiller.com/reference/theme_steve.html">theme_steve</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, color<span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span>, by<span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Values of Political Trust, Interacting Gender and Age"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"Interaction terms can be wonky to interpret from the regression output. Simulate them to make sense of them!"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Simulated Values of Political Trust (with 90% Intervals)"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         color <span class="op">=</span> <span class="st">""</span>, linetype <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"?som_sample in {simqi} (by way of SOM)."</span><span class="op">)</span></span></code></pre></div>
<p><img src="linear-model_files/figure-html/unnamed-chunk-12-1.png" width="912"></p>
</div>
<div class="section level2">
<h2 id="square-terms-and-the-like">Square Terms and the Like<a class="anchor" aria-label="anchor" href="#square-terms-and-the-like"></a>
</h2>
<p><code><a href="../reference/sim_qi.html">sim_qi()</a></code> works just fine with square terms you might
include by way of the <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code> function in base R. Here, let’s
drop the interactive effect of interest and explore a hypothesis of a
curvilinear relationship between age and political trust while
partialing out the effects of the gender variable and the education
category. You’d specify such a model like this, using the centered age
variable we just created.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">lptrust</span> <span class="op">~</span> <span class="va">c_age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">edu3</span>, <span class="va">Data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = lptrust ~ c_age + I(c_age^2) + female + edu3, data = Data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.44710 -0.56710 -0.00501  0.64608  3.00883 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) -7.110e-01  7.042e-02 -10.097  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; c_age        1.529e-03  9.815e-04   1.558    0.119    </span></span>
<span><span class="co">#&gt; I(c_age^2)   2.334e-04  5.485e-05   4.256 2.15e-05 ***</span></span>
<span><span class="co">#&gt; female       1.947e-01  3.368e-02   5.782 8.18e-09 ***</span></span>
<span><span class="co">#&gt; edu3         2.294e-01  2.610e-02   8.786  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8896 on 2836 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.04434,    Adjusted R-squared:  0.04299 </span></span>
<span><span class="co">#&gt; F-statistic: 32.89 on 4 and 2836 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The results suggest a potential non-linearity in age. At the least,
the square term for age is statistically significant but the other term
is not at any conventional threshold. However, what that means for
inferential takeaways wouldn’t be so clear from the regression output.
So, let’s use <code><a href="../reference/sim_qi.html">sim_qi()</a></code> to make sense of this. We’ll borrow
the <code>newdat</code> data frame we created above, but subset them to
just the women for ease of illustration. Then, let <code><a href="../reference/sim_qi.html">sim_qi()</a></code>
do its thing.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">newdat</span></span>
<span></span>
<span><span class="va">Sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_qi.html">sim_qi</a></span><span class="op">(</span><span class="va">M3</span>, nsim <span class="op">=</span> <span class="fl">100</span>, newdata <span class="op">=</span> <span class="va">newdat</span>, return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sims</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,000 × 6</span></span></span>
<span><span class="co">#&gt;         y   sim female c_age  edu3   age</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0.225      1      1 -<span style="color: #BB0000;">36.2</span>     2    16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0.207      1      1 -<span style="color: #BB0000;">35.2</span>     2    17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0.191      1      1 -<span style="color: #BB0000;">34.2</span>     2    18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0.175      1      1 -<span style="color: #BB0000;">33.2</span>     2    19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0.159      1      1 -<span style="color: #BB0000;">32.2</span>     2    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0.144      1      1 -<span style="color: #BB0000;">31.2</span>     2    21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 0.130      1      1 -<span style="color: #BB0000;">30.2</span>     2    22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0.116      1      1 -<span style="color: #BB0000;">29.2</span>     2    23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0.102      1      1 -<span style="color: #BB0000;">28.2</span>     2    24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 0.089<span style="text-decoration: underline;">5</span>     1      1 -<span style="color: #BB0000;">27.2</span>     2    25</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6,990 more rows</span></span></span></code></pre></div>
<p>Now, let’s summarize what we just did to make sense of what the
regression model is telling us.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sims</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>              mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>              upr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">.95</span><span class="op">)</span>,</span>
<span>              .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">mean</span>, ymin<span class="op">=</span><span class="va">lwr</span>, ymax<span class="op">=</span><span class="va">upr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://svmiller.com/reference/theme_steve.html">theme_steve</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.2</span>, color<span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span>, by<span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Values of Age and Political Trust for Women"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"We got some indication of non-linearity in the model, but simulation tells us what it 'looks like'."</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Simulated Values of Political Trust (with 90% Intervals)"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         color <span class="op">=</span> <span class="st">""</span>, linetype <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"?som_sample in {simqi} (by way of SOM)."</span><span class="op">)</span></span></code></pre></div>
<p><img src="linear-model_files/figure-html/unnamed-chunk-15-1.png" width="912"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steve Miller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
