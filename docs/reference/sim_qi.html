<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get simulations from a model object — sim_qi • simqi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get simulations from a model object — sim_qi"><meta name="description" content="sim_qi() is a function to simulate quantities of interest
from a regression model"><meta property="og:description" content="sim_qi() is a function to simulate quantities of interest
from a regression model"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simqi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get simulations from a model object</h1>

      <div class="d-none name"><code>sim_qi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>sim_qi()</code> is a function to simulate quantities of interest
from a regression model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_qi</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  original_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_newdata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vcov <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mod">mod<a class="anchor" aria-label="anchor" href="#arg-mod"></a></dt>
<dd><p>a model object</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>number of simulations to be run, defaults to 1,000</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>A data frame with a hypothetical prediction grid.
If absent, defaults to the model frame.</p></dd>


<dt id="arg-original-scale">original_scale<a class="anchor" aria-label="anchor" href="#arg-original-scale"></a></dt>
<dd><p>logical, defaults to TRUE. If TRUE, the ensuing
simulations are returned on their original scale. If FALSE, the ensuing
simulations are transformed to a more practical/intuitive quantity that is
potentially more intuitive for the user (e.g. a probability for a logistic
regression). This argument is ignored in the context of
simulations on the linear model.</p></dd>


<dt id="arg-return-newdata">return_newdata<a class="anchor" aria-label="anchor" href="#arg-return-newdata"></a></dt>
<dd><p>logical, defaults to FALSE. If TRUE, the output returns
additional columns corresponding with the inputs provided to <code>newdata</code>.
This may facilitate easier transformation along with greater clarity as to
what the simulations correspond.</p></dd>


<dt id="arg-vcov">vcov<a class="anchor" aria-label="anchor" href="#arg-vcov"></a></dt>
<dd><p>a manual variance-covariance matrix to supply to the simulation
process. Use with caution, and if you did some kind of on-the-fly standard
error adjustment in your regression model to make your results "robust". If
nothing is supplied, the model's default variance-covariance matrix is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>sim_qi()</code> returns a data frame (as a <code>tibble</code>) with the
quantities of interest and identifying information about the particular
simulation number. For linear models, or simple generalized linear models
where the dependent variable is either "there" or "not there", the quantity
of interest returned is a single column (called <code>y</code>). For models where the
underlying estimation of the dependent variable is, for lack of a better
term, "multiple" (e.g. ordinal models with the basic proportional odds
assumption), the columns returned correspond with the number of distinct
values of the outcome. For example, an ordinal model where there are five
unique values of the dependent variable will return columns <code>y1</code>, <code>y2</code>, <code>y3</code>,
<code>y4</code>, and <code>y5</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="supported-models">Supported Models<a class="anchor" aria-label="anchor" href="#supported-models"></a></h2>

<ol><li><p>Linear models produced by <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> in base R.</p></li>
<li><p>Generalized linear models produced by <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>. Families (links) include:</p><ul><li><p>Binomial (logit, probit)</p></li>
<li><p>Poisson (log)</p></li>
</ul></li>
<li><p>Cumulative link models produced by <span class="pkg">ordinal</span> package.</p><ul><li><p>Links: logit, probit</p></li>
</ul></li>
</ol><div class="section">
<h3 id="what-original-scale-does-in-this-function">What <code>original_scale</code> Does in This Function<a class="anchor" aria-label="anchor" href="#what-original-scale-does-in-this-function"></a></h3>


<p><code>original_scale</code> defaults to TRUE in this function. When TRUE, the simulated
quantity that's returned is a quantity on its "original scale." Understanding
what exactly that means requires some knowledge about the model in question
and what exactly the model is estimating on your behalf. In the simple linear
model produced by the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function in base R, this is straightforward (and,
thus, this argument does nothing for that model). The quantity returned is
the estimated value of the dependent variable. However, models with some kind
of link function return fitted values on some particular scale that might not
be so user-friendly (e.g. a probit index, or a natural logged odds). However,
that is the "original scale" on which the fitted values are returned. This
summary table may help you better understand what this argument does with
respect to what you want.</p><table class="table table"><tr><td><em>Model Function</em></td><td><em>Family (Link)</em></td><td><em>original_scale = TRUE</em></td><td><em>original_scale = FALSE</em></td></tr><tr><td><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></td><td>NA</td><td>NA (Estimated value of <em>y</em>)</td><td>NA (Estimated value of <em>y</em>)</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code></td><td>binomial(link='logit')</td><td>natural logged odds of <em>y</em> = 1</td><td>probability of <em>y</em> = 1</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code></td><td>binomial(link='probit')</td><td>probit index of <em>y</em> = 1</td><td>probability of <em>y</em> = 1</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code></td><td>poisson(link='log')</td><td>logged lambda</td><td>lambda</td></tr><tr><td><code>clm()</code></td><td>link = 'logit'</td><td>natural logged odds of <em>y</em> = value <em>j</em></td><td>probability of <em>y</em> = value <em>j</em></td></tr><tr><td><code>clm()</code></td><td>link = 'probit'</td><td>probit index of <em>y</em> = value <em>j</em></td><td>probability of <em>y</em> = value <em>j</em></td></tr></table><p>For ordinal models, I recommend setting <code>original_scale</code> to be FALSE. The
function, underneath the hood, is actually calculating things on the level of
the probability. It's just transforming back to a natural logged odds or a
probit index, if that is what you say you want.</p>
</div>

<div class="section">
<h3 id="other-details">Other Details<a class="anchor" aria-label="anchor" href="#other-details"></a></h3>


<p>Specifying a variable in <code>newdata</code> with the exact same name as the
dependent variable (e.g. <code>mpg</code> in the simple example provided in this
documentation file) is necessary for matrix multiplication purposes. The
function will do that for you if you have not done it yourself. It'll be set
by default to 0. It does not (should not?) matter for the simulations.</p>
<p>If you set <code>return_newdata</code> to <code>TRUE</code>, you should not interpret the column
matching the name of the dependent variable as communicating the kind of
information you want from this function. That particular column is just a
simple placeholder you need for matrix multiplication. The information you
want will always be in a column (or columns) named (or starting with) <code>y</code>.</p>
<p>I do not advise setting <code>return_newdata</code> to <code>TRUE</code> without providing a data
frame in <code>newdata</code> that corresponds with a hypothetical prediction grid. If
nothing is supplied in <code>newdata</code>, <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> is called and the
simulations are run on the data that inform the model itself.</p>
<p>This function builds in an implicit assumption that your dependent variable
in the regression model is not called <code>y</code>.</p>
<p>Factors (so-called "fixed effects") behave curiously in this function. For
just one factor variable in the model, the prediction grid you create must, at
a minimum, have the default/baseline category as the value for the factor in
question. For the presence of multiple factors, it seems like you need all
possible combinations of them (even if you don't want them). Future updates
will try to better understand this behavior.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8675309</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span></span>
<span class="r-in"><span><span class="va">Data</span><span class="op">$</span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Japan"</span>, <span class="st">"Japan"</span>, <span class="st">"Japan"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"Europe"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"Japan"</span>, <span class="st">"Japan"</span>, <span class="st">"Japan"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"USA"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">region</span>, <span class="va">Data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">sim_qi</span><span class="op">(</span><span class="va">M1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 320 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        y   sim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  23.7     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  23.7     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  24.3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  19.1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  16.6     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  19.3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  14.0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  25.0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  23.8     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  22.8     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 310 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">newdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="fl">0</span>, region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Europe"</span>, <span class="st">"Japan"</span>, <span class="st">"USA"</span><span class="op">)</span>, hp <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">sim_qi</span><span class="op">(</span><span class="va">M1</span>, nsim <span class="op">=</span> <span class="fl">100</span>, <span class="va">newdat</span>, return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 300 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        y   sim   mpg region    hp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  21.6     1     0 Europe   123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  26.1     1     0 Japan    123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  19.4     1     0 USA      123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  22.4     2     0 Europe   123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  20.1     2     0 Japan    123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  19.3     2     0 USA      123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  22.9     3     0 Europe   123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  24.3     3     0 Japan    123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  19.7     3     0 USA      123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  22.5     4     0 Europe   123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 290 more rows</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steve Miller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

